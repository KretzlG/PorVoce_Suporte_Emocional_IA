{% extends "dashboards/dashboard-base.html" %}

{% block title %}Dashboard Administrativo - ForYou{% endblock %}
{% block page_title %}Dashboard Administrativo{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='dashboards/css/dashboard-base.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='dashboards/css/premium-overrides.css') }}">
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='dashboards/js/charts.js') }}"></script>
{% endblock %}

{% block dashboard_content %}
<div class="container-fluid">
	<div class="row">
		<div class="col-lg-4 mb-4">
			<div class="card shadow-sm border-0">
				<div class="card-body">
					<h6 class="fw-semibold mb-3">Ações Rápidas</h6>
					<a href="{{ url_for('training.index') }}" class="btn btn-primary me-2 mb-2">
						<i class="fas fa-robot"></i> Treinar IA
					</a>
				</div>
			</div>
		</div>
		<div class="col-xl-3 col-md-6 mb-4">
			<div class="card bg-light-primary shadow-sm border-0">
				<div class="card-body d-flex align-items-center">
					<div class="me-3 display-6 text-primary"><i class="fas fa-users"></i></div>
					<div>
						<div class="fs-6 fw-semibold text-uppercase mb-1">Usuários</div>
						<div class="fs-3 fw-bold" data-counter="{{ stats.total_users|default(0) }}">0</div>
						<div class="text-muted small">Cadastrados</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-xl-3 col-md-6 mb-4">
			<div class="card bg-light-success shadow-sm border-0">
				<div class="card-body d-flex align-items-center">
					<div class="me-3 display-6 text-success"><i class="fas fa-user-friends"></i></div>
					<div>
						<div class="fs-6 fw-semibold text-uppercase mb-1">Voluntários</div>
						<div class="fs-3 fw-bold" data-counter="{{ stats.active_volunteers|default(0) }}">0</div>
						<div class="text-muted small">Ativos</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-xl-3 col-md-6 mb-4">
			<div class="card bg-light-info shadow-sm border-0">
				<div class="card-body d-flex align-items-center">
					<div class="me-3 display-6 text-info"><i class="fas fa-comments"></i></div>
					<div>
						<div class="fs-6 fw-semibold text-uppercase mb-1">Conversas</div>
						<div class="fs-3 fw-bold" data-counter="{{ stats.total_sessions|default(0) }}">0</div>
						<div class="text-muted small">Realizadas</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-xl-3 col-md-6 mb-4">
			<div class="card bg-light-danger shadow-sm border-0">
				<div class="card-body d-flex align-items-center">
					<div class="me-3 display-6 text-danger"><i class="fas fa-exclamation-triangle"></i></div>
					<div>
						<div class="fs-6 fw-semibold text-uppercase mb-1">Alertas</div>
						<div class="fs-3 fw-bold" data-counter="{{ stats.critical_alerts|default(0) }}">0</div>
						<div class="text-muted small">Críticos</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-lg-8 mb-4">
			<div class="card shadow-sm border-0">
				<div class="card-body">
					<div class="d-flex justify-content-between align-items-center mb-3">
						<h5 class="fw-bold mb-0">Crescimento de Usuários</h5>
					</div>
					<canvas id="usersChart"></canvas>
				</div>
			</div>
		</div>
		<div class="col-lg-4 mb-4">
			<div class="card shadow-sm border-0">
				<div class="card-body">
					<h5 class="fw-bold mb-3">Distribuição de Risco</h5>
					<canvas id="riskChart"></canvas>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-md-4 mb-4">
			<div class="card shadow-sm border-0">
				<div class="card-body">
					<h6 class="fw-semibold mb-1">Taxa de Satisfação</h6>
					<div class="fs-2 fw-bold mb-0" data-counter="{{ stats.satisfaction_rate|default(0) }}">0%</div>
					<div class="text-muted small">Baseado em feedbacks</div>
				</div>
			</div>
		</div>
		<div class="col-md-4 mb-4">
			<div class="card shadow-sm border-0">
				<div class="card-body">
					<h6 class="fw-semibold mb-1">Tempo Médio de Resposta</h6>
					<div class="fs-2 fw-bold mb-0" data-counter="{{ stats.avg_response_time|default(0) }}">0min</div>
					<div class="text-muted small">Minutos</div>
				</div>
			</div>
		</div>
		<div class="col-md-4 mb-4">
			<div class="card shadow-sm border-0">
				<div class="card-body">
					<h6 class="fw-semibold mb-1">Problemas Resolvidos</h6>
					<div class="fs-2 fw-bold mb-0" data-counter="{{ stats.resolved_issues|default(0) }}">0</div>
					<div class="text-muted small">No período</div>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-12 mb-4">
			<div class="card shadow-sm border-0">
				<div class="card-body">
					<h5 class="fw-bold mb-3">Atividades Recentes</h5>
					<div class="table-responsive">
						<table class="table align-middle mb-0">
							<thead>
								<tr>
									<th>Usuário</th>
									<th>Ação</th>
									<th>Data/Hora</th>
									<th>Status</th>
								</tr>
							</thead>
							<tbody>
								{% for activity in recent_activities %}
								<tr>
									<td>{{ activity.user_name }}</td>
									<td>{{ activity.action }}</td>
									<td>{{ activity.timestamp }}</td>
									<td><span class="badge {{ activity.status_class }}">{{ activity.status_label }}</span></td>
								</tr>
								{% else %}
								<tr><td colspan="4">Nenhuma atividade recente.</td></tr>
								{% endfor %}
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}
